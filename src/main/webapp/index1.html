<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Unito</title>
    <!-- import Vue, Ajax, BootsTrap, javascript e css -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- BootsTrap -->
    <link href="Style.css" rel="stylesheet"> <!-- Nostro css -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script> <!-- Vue -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> <!-- Ajax -->
</head>
<body>
<div id="app">

    <loginform ref="templateApp"></loginform>
    <bottoni ref="templateBottoni"></bottoni>
    <div class="container align-middle col-8 hide" id="loggato"></div>

</div>

<script>

    // script Vue.js

    //componente e template per l'html del form di login, compreso di logica dei bottoni e richiamo della servlet.
    var loginFormJS = Vue.component('loginform', {

        template: `
          <div v-show="isActive" class="w-25 p-3 position-absolute top-50 start-50 translate-middle">

          <form v-on:submit.prevent="login">
            <div class="form-group">
              <label for="username">Username</label>
              <input type="text" class="form-control" aria-describedby="emailHelp" id="username" required
                     autocomplete="off">
            </div>
            <div class="form-group">
              <label for="password">Password</label>
              <input type="password" class="form-control" id="password" required autocomplete="off">
            </div>
            <input type="submit" class="btn btn-primary" id="logga" value="login">
          </form>
          </div>
        `,
        data() {
            return {
                isActive: true
            };
        }
        ,
        methods: {
            showForm() {
                this.isActive = !this.isActive;
            },


        }
    });

    //componente e template per l'html dei bottoni che appaiono una volta loggato, compresi di logica e richiami della servlet.
    var bottoniJS = Vue.component('bottoni', {
        template: `
          <div v-if="ruolo.trim() === 'cliente'">
          <p class='w-25 p-3 position-absolute top-0 start-0'>Sei loggato come Utente</p>
          <button type='button' class='btn btn-primary position-absolute top-0 start-50 ' id='ripetizioni'
                  v-on:click="showRipetizioni">Ripetizioni Disponibili
          </button>
          <button type='button' class='btn btn-primary position-absolute top-0 end-50 ' id='prenotazione'
                  v-on:click="showPrenotazione">Cronologia Prenotazioni
          </button>

          </div>

          <div v-else-if="ruolo.trim() === 'amministratore'" class="button-box">
          <p class='w-25 p-3 position-absolute top-0 start-50'>Sei loggato come Amministratore</p>
          <button type='button' class='btn btn-primary  text-center ' id='ripetizioni'
                  v-on:click="showRipetizioni">Ripetizioni Disponibili
          </button>
          <button type='button' class='btn btn-primary  text-center ' id='prenotazione'
                  v-on:click="showPrenotazioneAmministratore">Cronologia Prenotazioni
          </button>
          <button type='button' class='btn btn-primary  text-center ' id='Docenti'
                  v-on:click="showDocente">Docenti
          </button>
          <button type='button' class='btn btn-primary  text-center ' id='Corsi'
                  v-on:click="showCorso">Corsi
          </button>
          <button type='button' class='btn btn-primary text-center ' id='Insegna'
                  v-on:click="showInsegna">Insegna
          </button>
          </div>
        `,
        data() {
            return {
                ruolo: "",
                stampa: "",
            };
        }
        ,
        methods: {
            showForm() {
                this.isActive = !this.isActive;
            },

            passaRuolo(s) {
                this.ruolo = s;
            },

            showRipetizioni() {
                var azione = "showRipetizioni";
                var self = this;
                var result = ""; //risultato della query
                var tabella = ""; //stampa tabella
                var i = 1; //contatore delle righe

                $.post("ModificaServlet", {azione: azione},
                    function (ServletOutput) {

                        result = $.parseJSON(ServletOutput);

                        tabella = '<table class="table">\
                                   <thead>\
                                        <tr>\
                                            <th scope="col">Prenota</th>\
                                            <th scope="col">#</th>\
                                            <th scope="col">Nome</th>\
                                            <th scope="col">Cognome</th>\
                                            <th scope="col">Materia</th>\
                                            <th scope="col">Data</th>\
                                            <th scope="col">Ora</th>\
                                        </tr>\
                                   </thead>\
                                   <tbody>';


                        $.each(result, function (key, value) {


                            tabella += "  <tr>\
                                            <td><input class='form-check-input' type='radio'  id='radio" + i + "' value='radio" + i + "' name='radio'></td>\
                                            <td>" + i + "</td>\
                                            <td>" + value['nome'] + "</td>\
                                            <td>" + value['cognome'] + "</td>\
                                            <td>" + value['materia'] + "</td>\
                                            <td>" + value['data'] + "</td>\
                                            <td>" + value['ora'] + "</td>\
                                        </tr>";
                            i++;
                        });

                        //console.log(document.getElementById("checkbox1").value);

                        tabella += '</tbody>\n' +
                            '</table>';
                        tabella += '<button class="btn btn-success" id="btnPrenota" v-on:click="showPrenotazione">Prenota</button>';
                        $("#loggato").css({"visibility": "visible"});
                        $("#loggato").html(tabella);
                        console.log(radio1.value);
                    }
                );

            },
            showDocente() {
                var azione = "showDocente";
                var self = this;
                var result = "";
                var tabella = "";
                var i = 1;

                $.post("ModificaServlet", {azione: azione},
                    function (ServletOutput) {

                        result = $.parseJSON(ServletOutput);

                        console.log(ServletOutput);

                        tabella = '<table class="table">\
                                   <thead>\
                                        <tr>\
                                           \<th scope="col">idDocente</th>\
                                            <th scope="col">Nome</th>\
                                            <th scope="col">Cognome</th>\
                                        </tr>\
                                   </thead>\
                                   <tbody>';


                        $.each(result, function (key, value) {
                            tabella += "  <tr>\
                                            <td>" + value['id'] + "</td>\
                                            <td>" + value['nome'] + "</td>\
                                            <td>" + value['cognome'] + "</td>\
                                        </tr>";
                            i++;
                        });

                        tabella += '</tbody>\n' +
                            '</table>';
                        $("#loggato").css({"visibility": "visible"});
                        $("#loggato").html(tabella);
                    }
                )
            },
            showInsegna() {
                var azione = "showInsegna";
                var self = this;
                var result = "";
                var tabella = "";
                var i = 1;

                $.post("ModificaServlet", {azione: azione},
                    function (ServletOutput) {

                        result = $.parseJSON(ServletOutput);

                        console.log(ServletOutput);

                        tabella = '<table class="table">\
                                   <thead>\
                                        <tr>\
                                           \<th scope="col">idDocente</th>\
                                            \<th scope="col">Corso</th>\
                                        </tr>\
                                   </thead>\
                                   <tbody>';


                        $.each(result, function (key, value) {
                            tabella += "  <tr>\
                                            \<td>" + value['idDocente'] + "</td>\
                                            \<td>" + value['materia'] + "</td>\
                                        </tr>";
                            i++;
                        });

                        tabella += '</tbody>\n' +
                            '</table>';
                        $("#loggato").css({"visibility": "visible"});
                        $("#loggato").html(tabella);
                    }
                )
            },
            showCorso() {
                var azione = "showCorso";
                var self = this;
                var result = "";
                var tabella = "";
                var i = 1;

                $.post("ModificaServlet", {azione: azione},
                    function (ServletOutput) {

                        result = $.parseJSON(ServletOutput);
                        console.log(ServletOutput);

                        tabella = '<table class="table">\
                                   <thead>\
                                        <tr>\
                                           \<th scope="col">Materia</th>\
                                        </tr>\
                                   </thead>\
                                   <tbody>';


                        $.each(result, function (key, value) {
                            tabella += "  <tr>\
                                            <td>" + value['Materia'] + "</td>\
                                        </tr>";
                            i++;
                        });

                        tabella += '</tbody>\n' +
                            '</table>';
                        $("#loggato").css({"visibility": "visible"});
                        $("#loggato").html(tabella);
                    }
                )
            },
            showPrenotazione() {
                var azione = "showPrenotazione";
                var self = this;
                var result = "";
                var tabella = "";
                var i = 1;

                $.post("ModificaServlet", {azione: azione},
                    function (ServletOutput) {

                        result = $.parseJSON(ServletOutput);

                        console.log(ServletOutput);

                        tabella = '<table class="table">\
                                   <thead>\
                                        <tr>\
                                            <th scope="col">#</th>\
                                            <th scope="col">Nome</th>\
                                            <th scope="col">Cognome</th>\
                                            <th scope="col">Materia</th>\
                                            <th scope="col">Data</th>\
                                            <th scope="col">Ora</th>\
                                            <th scope="col">Stato</th>\
                                        </tr>\
                                   </thead>\
                                   <tbody>';


                        $.each(result, function (key, value) {
                            tabella += "  <tr>\
                                        <th scope='row'>" + i + "</th>\
                                            <td>" + value['nome'] + "</td>\
                                            <td>" + value['cognome'] + "</td>\
                                            <td>" + value['materia'] + "</td>\
                                            <td>" + value['data'] + "</td>\
                                            <td>" + value['ora'] + "</td>\
                                            <td>" + value['stato'] + "</td>\
                                        </tr>";
                            i++;
                        });

                        tabella += '</tbody>\n' +
                            '</table>';
                        $("#loggato").css({"visibility": "visible"});
                        $("#loggato").html(tabella);
                    }
                )
            },
            showPrenotazioneAmministratore() {
                var azione = "showPrenotazioneAmministratore";
                var self = this;
                var result = "";
                var tabella = "";
                var i = 1;

                $.post("ModificaServlet", {azione: azione},
                    function (ServletOutput) {

                        result = $.parseJSON(ServletOutput);

                        console.log(ServletOutput);

                        tabella = '<table class="table">\
                                   <thead>\
                                        <tr>\
                                            <th scope="col">#</th>\
                                            <th scope="col">Nome</th>\
                                            <th scope="col">Cognome</th>\
                                            <th scope="col">Materia</th>\
                                            <th scope="col">Data</th>\
                                            <th scope="col">Ora</th>\
                                            <th scope="col">Stato</th>\
                                        </tr>\
                                   </thead>\
                                   <tbody>';


                        $.each(result, function (key, value) {
                            tabella += "  <tr>\
                                        <th scope='row'>" + i + "</th>\
                                            <td>" + value['nome'] + "</td>\
                                            <td>" + value['cognome'] + "</td>\
                                            <td>" + value['materia'] + "</td>\
                                            <td>" + value['data'] + "</td>\
                                            <td>" + value['ora'] + "</td>\
                                            <td>" + value['stato'] + "</td>\
                                        </tr>";
                            i++;
                        });

                        tabella += '</tbody>\n' +
                            '</table>';
                        $("#loggato").css({"visibility": "visible"});
                        $("#loggato").html(tabella);
                    }
                );

            }
        },
    });

    var tabelle = Vue.component('tabelle', {
        template: `
        <div v-if="bottone=='prenotazione'>"
        <table class="table">
                                   <thead>
                                        <tr>
                                            <th scope="col">#</th>
                                            <th scope="col">Nome</th>
                                            <th scope="col">Cognome</th>
                                            <th scope="col">Materia</th>
                                            <th scope="col">Data</th>
                                            <th scope="col">Ora</th>
                                            <th scope="col">Stato</th>
                                        </tr>
                                   </thead>
                                   <tbody>
                                   <div v-for="(colonna, valore) in tabella" >
                                        <th scope='row'>" + i + "</th>
                                            <td>" {{colonna}} "</td>
                                            <td>" + value['cognome'] + "</td>
                                            <td>" + value['materia'] + "</td>
                                            <td>" + value['data'] + "</td>
                                            <td>" + value['ora'] + "</td>
                                            <td>" + value['stato'] + "</td>
                                        </tr>";
                                   </div>
                                   </tbody>
        </table>
        </div>
        <div v-else-if=="bottone=='showDocente'>


        </div>
        `,
        mounted() {
            //showprenotazione
        }
    });

    // inizializzazione del vue model
    var vm = new Vue({

        el: '#app',
        data: {},
        methods: {}

    });


    // script Ajax
    function isEmpty(el) {
        return !$.trim(el.html())
    }

    $(document).on('click', 'btnPrenota', function () {
        alert("test");
    });
</script>
</body>
</html>